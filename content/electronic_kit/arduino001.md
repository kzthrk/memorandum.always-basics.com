---
title: "Arduinoでリモコンを作ろう"
date: 2020-02-08T15:10:52+09:00
Categories: ["電子工作"]
Tags: ["Arduino"]
Description: "Arduinoでリモコンを作成"
draft: false
---

# 概要
Arduinoでリモコンを作成してみたいと思います。作成するリモコンは赤外線を使った一般的なリモコンです。いわゆるテレビやエアコンなどを操作するリモコンで、単純にリモコン側から赤外線を使った信号を送りつけ、本体が側がそれに反応しているタイプのものです。

一部のリモコンには一方通行ではないものがあるようですが、今回作成するArduinoのリモコンはそれには対応していません。

# 準備するもの

Arduinoでリモコンを作成するにあたり、必要なパーツを以下にリストします。まず**Arduinoでリモコンに特化したもの**を先に挙げます。続いて、ArduinoでLチカだったり、Raspberry Piでリモコンだったり、いわゆる**電子工作として一般的に必要なもの**をリストします。この分類は微妙な線引きではありますが、察してやって下さい。

## Arduinoでリモコンに必要なもの

|価格|品名|備考|
|------|---------------------------------|-----------------------------|
|100円|[赤外線リモコン受信モジュール OSRB38C9AA（2個入）](http://akizukidenshi.com/catalog/g/gI-04659/)||
|100円|[5mm 赤外線LED OSI5LA5113A（10個入）](http://akizukidenshi.com/catalog/g/gI-12612/)|可視光線のLEDもあると動作確認に便利。赤外線は目に見えないので。|
|200円|[抵抗 27Ω 1W（100本入）](http://akizukidenshi.com/catalog/g/gR-07960/)|これである必要はありません。実際、最終的には並行に繋いで抵抗を下げました。|
|1980円|[ESPr® Developer（ESP-WROOM-02開発ボード）](https://www.switch-science.com/catalog/2500/)|これも他のArduinoでもOKです。実際最初はUnoを使って試していました|

## 電子工作として一般的に必要なもの
|参考価格|品名|商品例|
|------|-----------------------------------|-----------------------------|
|35円|ピンヘッダ|[ピンヘッダ　１×４０　（４０Ｐ）](http://akizukidenshi.com/catalog/g/gC-00167/)|
|270円|ブレッドボード|[ブレッドボード（1枚）](http://akizukidenshi.com/catalog/g/gP-00315/)|
|180円|ジャンパーワイヤ|[ブレッドボード・ジャンパーワイヤ（オス－オス）　１０ｃｍセット](http://akizukidenshi.com/catalog/g/gC-05371/) |
|60円|ユニバーサル基板 |[片面ガラスコンポジット・ユニバーサル基板　Ｃタイプ　めっき仕上げ　（７２×４７ｍｍ）　日本製](http://akizukidenshi.com/catalog/g/gP-03229/)|
|210円|はんだ|[はんだ　０．８ｍｍ](http://akizukidenshi.com/catalog/g/gT-02594/)|
|2,300円|はんだごて|[即熱はんだこて　ＴＱ－９５（９０Ｗ／１５Ｗ）](http://akizukidenshi.com/catalog/g/gT-02534/)|

これらに関しては、これでなければダメというものでもありませんし、道具の類いは特に好みやこだわりもあると思いますので、手持ちのものをご使用いただくか、必要に応じて購入(場合によっては我慢)するなど、適宜ご判断の上お願いします。

# 実装

まずは純粋にArduinoでリモコン作りをしたいと思います。その後、使用しているArduinoがWi-Fiをしゃべることから、リモコンのリモコン化(Web化)をしたいと思います。

## 実装その1

まずは純粋にArduinoでリモコンです。

### 回路



### スケッチ



### 動作確認

## 上手く動作しない場合

### デバッグその1
赤外線LEDが本当に光っているかが最も気になるところかと思いますが、それを確かめる方法を紹介する前に、まずは可視光を放つLEDでデバッグしてみましょう。

スケッチに変更はありません。ただただLEDを可視光を放つLEDに変更してみます。

### デバッグその2
可視光のLEDが実際に光った場合、それでも赤外線LEDは光っていないのではないかと疑心暗鬼になる気持ち、十分すぎるほどに分かります。私自身がそうでした。

過去には携帯電話(ガラケー)のカメラであれば、赤外線の光線を撮影することが可能でした。最近のスマートフォンの場合は赤外線をカットしているものがあり、お手元のスマートフォンで写るかどうかは分かりませんが、幸いなことにお手元のリモコンは確実に赤外線を発しているはずで、それを撮影することで写るカメラであるかどうかはすぐに判断可能です。

なお、iPhoneの場合にはインカメラ(液晶画面側のカメラ)であれば赤外線の光が写ります。

そのカメラを使って赤外線LEDが光っているかを確かめてみましょう。

>>>写真<<<

## 実装その2

### 回路

### スケッチ

今回Arduinoとして用いたのは[https://www.switch-science.com/catalog/2346/](ESP-WROOM-02)を用いた[https://www.switch-science.com/catalog/2500/](ESPr® Developer（ESP-WROOM-02開発ボード）)です。このボードの用いた理由は、一番は私のような素人でも取り扱いやすいということですが、同時にWi-Fiで制御することが可能になります。

具体的にはArduinoをWebサーバーとして自宅のWi-Fiルータに接続しています。その上で、リモコンの各ボタンをURLと紐付けてアクセスされたURLに応じて赤外線のシグナルを発信するという算段です。
さらにもう一つ工夫をしています。それはHTMLを外部に持たせていることです。ArduinoをWebサーバーしたのは良いのですが、HTMLを返させるには少々編集に手間が掛かります。
そこでHTMLは外部のサーバーに配置しています。Webブラウザからみるとリンク先が自宅内のネットワーク上にあるWebサーバーを指していますので、HTTPリクエストは無事にArduinoへ届きます。Arduinoでは"302 Moved Temporarily"を返し、再び外部のWebサーバー上のHTMLへ戻るようにしています。

この方法は、ArduinoにWebSocketをしゃべらせて外部サーバーと通信させるケースに比べてセキュリティに優れていると言えます。今回はHTML内のIPアドレスを固定で書き込んでいますが、自宅のWi-Fi環境においてDHCPとなっているのであれば、外部のWebサーバー上でIPアドレスを受領して動的にHTMLを生成して返却するようなサーバー側の仕組みを用意すれば良いでしょう。

一つ言えることは、この方法はいろいろな回路を組み、色々と外部から操作したいと思ったときに、選択の幅を広げることになると思いますので是非この機会にお試し下さい。

# 編集後記
軟弱な(Softwareな)世界に生きていると、電子工作(ハード)な世界のデバッグのやりづらさたるや半端ない負担で、実際にはこれもう一つ回路設計しないと分からないのでは？と思うこともあるほどですが...
今回は実際、予備の意味もあって受信モジュールを2つ買っておいたので、お迎え合わせにもう一つリモコン回路を作ってお迎え合わせにして確かめました。



